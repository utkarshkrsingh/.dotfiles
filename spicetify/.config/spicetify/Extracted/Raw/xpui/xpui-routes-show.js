"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[8606],{52633:(e,t,a)=>{a.d(t,{I:()=>l});var i=a(30758),s=a(60007),n=a(89494),r=a(49066),o=a(86070);const l=i.memo((function({uri:e,size:t=s.M.md,className:a,onClick:l,canDownload:c,condensedAll:d}){const[u,m]=(0,r.A)(e),p=(0,n.W)(),h=(0,i.useCallback)((()=>{p({targetUri:e,intent:u?"unsave":"save",type:"click"}),m(!u)}),[p,e,u,m]);return(0,o.jsx)(s.f,{className:a,isFollowing:u,onFollow:h,onClick:l,uri:e,size:t,canDownload:c,condensedAll:d,condensed:!0})}))},15783:(e,t,a)=>{a.d(t,{G:()=>P});var i=a(97500),s=a.n(i),n=a(64721),r=a(6128);const o="YNXLVjlRXPfM4xObTojA",l="CVRy4NtxZYSle8dJ1E67",c="holKDGFNEFSz85czBeSv",d="gqidZhN1lgoZDfI_7E6w",u="_IQ8dgA5pEr_V8PfUkWa",m="xNkPMA_OvAxcFTdfyroI";var p=a(86070);const h=({value:e,label:t,hasDivider:a=!1})=>(0,p.jsxs)("div",{className:c,"aria-hidden":"true",children:[(0,p.jsx)(r.E,{variant:"titleSmall",className:s()({[u]:a}),children:e}),(0,p.jsx)(r.E,{variant:"marginal",semanticColor:"textSubdued",children:t})]});var g=a(30758);const x=1e3,y=60*x,v=60*y,b=24*v;var j=a(43163),f=a(1429);const C={days:0,hours:0,minutes:0,seconds:0};function k(e){return e>0?function(e){const t=Math.abs(e);return{days:Math.floor(t/b),hours:Math.floor(t%b/v),minutes:Math.floor(t%v/y),seconds:Math.floor(t%y/x)}}(e):C}var w=a(41861),S=a(24902);const P=({targetDate:e,className:t,onComplete:a,images:i,imageTitle:r})=>{const{days:c,hours:u,minutes:x,seconds:y}=((e,t)=>{const a=(0,g.useRef)(t);a.current=t;const[i,s]=(0,g.useState)((()=>k((0,j.u)(e))));return(0,f.$)((t=>{const i=(0,j.u)(e),n=k(i);s(n),i<=0&&(t(),a.current?.())}),1e3),i})(e,a),v=void 0!==i&&i.length>0&&r,b=n.Ru.get("web-player.prerelease.countdown_label",{days:c,hours:u,minutes:x,seconds:y});return(0,p.jsxs)("div",{className:s()(o,t,{[l]:v}),role:"timer",children:[(0,p.jsx)("span",{className:m,children:b}),v&&(0,p.jsx)(w.b,{images:i,type:S.c.ALBUM,shape:w.u.ROUNDED_CORNERS,className:d,title:r}),(0,p.jsx)(h,{value:c,label:n.Ru.get("web-player.prerelease.days",c),hasDivider:!0}),(0,p.jsx)(h,{value:u,label:n.Ru.get("web-player.prerelease.hours",u),hasDivider:!0}),(0,p.jsx)(h,{value:x,label:n.Ru.get("web-player.prerelease.minutes",x),hasDivider:!0}),(0,p.jsx)(h,{value:y,label:n.Ru.get("web-player.prerelease.seconds",y)})]})}},92295:(e,t,a)=>{a.d(t,{W:()=>o});var i=a(30758),s=a(29004),n=a(64721),r=a(86070);const o=(0,i.memo)((function({isFollowing:e,onClick:t,disabled:a=!1,buttonText:i,size:o="small",className:l}){const c=e?n.Ru.get("following"):n.Ru.get("follow");return(0,r.jsx)(s.n,{onClick:t,disabled:a,size:o,className:l,children:i||c})}))},27063:(e,t,a)=>{a.d(t,{h:()=>u});var i=a(30758),s=a(37435),n=a(15470),r=a(65311),o=a(13723),l=a(25214);var c=a(79365),d=a(86070);const u=({children:e,action:t,uri:a})=>{const u=(0,r.V)(),m=(0,l.N)(o.JD);let p;const h=()=>{const e={triggerId:n.d,triggerAction:{type:t}};s.h.set((t=>({...t,...e}))),m.storeAction(o.j8,{operation:c.tS.ADD,uris:[a]})};try{p=i.Children.only(e)}catch(t){return(0,d.jsx)(d.Fragment,{children:e})}return u?i.cloneElement(p,{onClick:h}):(0,d.jsx)(d.Fragment,{children:e})}},31793:(e,t,a)=>{a.d(t,{H4:()=>i});a(30758),a(97500),a(64721),a(43494),a(39177);a(86070);let i=function(e){return e.primary="primary",e.secondary="secondary",e.transparent="transparent",e}({})},26851:(e,t,a)=>{a.d(t,{v:()=>m});var i=a(29004),s=a(69175),n=a(61214),r=a(16348),o=a(64721),l=a(27063),c=a(34482),d=a(85576),u=a(86070);const m=({uri:e,isBook:t=!1})=>{const{isPreSaved:a,addPresave:m,removePresave:p}=(0,c.w)({uri:e,isBook:t});return a?(0,u.jsx)(i.n,{onClick:p,iconTrailing:s.k,children:o.Ru.get("web-player.prerelease.presaved")}):(0,u.jsx)(l.h,{uri:e,action:d.no.SAVE_PRERELEASE,children:(0,u.jsx)(n.$,{disabled:void 0===a,onClick:m,iconTrailing:r.P,children:o.Ru.get("web-player.prerelease.presave")})})}},1335:(e,t,a)=>{a.d(t,{g:()=>A});var i=a(30758),s=a(3074),n=a.n(s),r=a(56570),o=a(92441),l=a(6128),c=a(63166),d=a(11846),u=a(44979),m=a(29213),p=a(85834),h=a(99903),g=a(1127),x=a(12433),y=a(89865),v=a(64721),b=a(41617),j=a(67579),f=a(86070);const C=({onSelect:e})=>{const{viewMode:t,setViewMode:a}=(0,b.a)();return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(g.y,{children:v.Ru.get("web-player.your-library-x.sort-and-view-picker.view-as")}),j.i.map((({value:i,icon:s,text:n},r)=>(0,f.jsx)(x.D,{role:"menuitemradio","aria-checked":t===i,divider:r===j.i.length-1?"after":void 0,autoClose:!1,leadingIcon:s(),onClick:()=>{a(i),e?.(i)},children:n()},i)))]})},k=({heading:e,selected:t,onSelect:a,options:i,enableViewModeMenu:s=!1,onSelectViewMode:n,sortOrder:r,...o})=>{let l;r&&(r===y.H.ASC||r===y.H.SECONDARY_ASC?l=m.U:r!==y.H.DESC&&r!==y.H.SECONDARY_DESC||(l=p.R));return(0,f.jsxs)(h.W,{getInitialFocusElement:e=>e?.querySelector('[aria-checked="true"]'),...o,children:[e?(0,f.jsx)(g.y,{children:e}):null,i.map((({key:e,value:i},s)=>(0,f.jsx)(x.D,{role:"menuitemradio","aria-checked":e===t.key,CheckedIcon:l,onClick:()=>a(e,s),children:i},e))),s&&(0,f.jsx)(C,{onSelect:n})]})};var w=a(30164),S=a(1620),P=a(27602);const R="x-sortBox-sortDropdown",E="cvTLPmjt6T7M85EKcB8w",N="SbDHY3fVADNJ4l9qOLQ2",I=({isOpen:e,className:t})=>e?(0,f.jsx)(r.J,{size:"small","aria-hidden":"true",className:t}):(0,f.jsx)(o.y,{size:"small","aria-hidden":"true",className:t}),A=({heading:e,options:t,selected:a,onSelect:s,sortOrder:r,variant:o="bodySmall",semanticColor:m,disabled:p,onClick:h,ariaLabel:g,enableViewModeMenu:x=!1})=>{const y=(0,c.NC)(P.mA)&&x,{viewMode:v}=(0,w.a)();a||(a=t?.[0]);const b=j.i.find((({value:e})=>e===v))||j.i[0],C=(0,i.useMemo)((()=>`sortboxlist-${n().create().hex}`),[]),{spec:A,logger:B}=(0,S.r)(d.d,{});return(0,f.jsx)(u.b,{menu:(0,f.jsx)(k,{selected:a,options:t,onSelect:(e,t)=>{s(e,t);const a=A.sortBySectionFactory().sortOptionFactory({identifier:e}).hitSort();B.logInteraction(a)},sortOrder:r,heading:e,enableViewModeMenu:y,onSelectViewMode:e=>{const t=A.viewAsSectionFactory().viewOptionFactory({identifier:e}).hitUiElementToggle();B.logInteraction(t)},id:C}),children:(e,t,i)=>(0,f.jsxs)("button",{className:R,onClick:e=>{p||(h?.(e),t(e))},ref:i,type:"button","aria-label":g,role:"combobox","aria-controls":C,"aria-expanded":e,children:[(0,f.jsx)(l.E,{"data-sortbox-label":!0,semanticColor:m,variant:o,className:E,children:a?.value||(y?b.text():"")}),y?b.icon():(0,f.jsx)(I,{isOpen:e,className:N})]})})}},37769:(e,t,a)=>{a.d(t,{N:()=>h});var i=a(97500),s=a.n(i),n=a(30758),r=a(96613),o=a(55285);const l="nLNTsyonBwoRIzAv1AME",c="E4I5I7G2CfW32hLWZaqE",d="w4ZoklZWkrsyrVA34vI8";var u=a(86070);const m=({title:e,uri:t,className:a,onClick:i,position:l})=>{const m=(0,n.useCallback)((e=>{i?.(e,{uri:t,position:l})}),[i,l,t]);return(0,u.jsx)(o.N,{"aria-label":e,className:s()(c,d,a),to:t,onClick:m,children:(0,u.jsx)(r.v,{as:"span",children:e})})};function p(e){return!!e.uri&&!!e.title}const h=({topics:e,className:t,onClick:a})=>(0,u.jsx)("div",{className:s()(l,t),children:e.filter(p).map(((e,t)=>{const i=`${e.uri}-${t}`;return(0,u.jsx)(m,{title:e.title,uri:e.uri,position:t,onClick:a},i)}))})},8549:(e,t,a)=>{a.d(t,{B:()=>E,q:()=>I});var i=a(30758),s=a(95440),n=a(31652),r=a(75627),o=a(63642),l=a(9885),c=a(13377),d=a(48732),u=a(68371),m=a(37435),p=a(30860),h=a(48253),g=a(92057),x=a(89494),y=a(65311),v=a(1817),b=a(61155),j=a(95309),f=a(90089),C=a(40564),k=a(33058),w=a(1620),S=a(19434),P=a(30057),R=a(86070);function E(e){return{uri:e.uri,name:e.name,trailer:e.trailer,showTypes:e.showTypes}}const N=e=>`activation-trigger-mme-${e}`,I=i.memo((function({index:e=-1,showMetadata:t,episode:a,usePlayContextItem:I,status:A,variant:B}){const _=(0,v.c)(),F=a.playedState.playPositionMilliseconds,T=a.uri,U=(0,i.useRef)(null),[D,M]=(0,i.useState)(a.playedState.state===S._w.Completed),{draggable:L,onDragStart:O}=(0,g.P)(),z=(0,y.V)(),V=(0,f.y)(),W=(0,x.W)(),H=(0,s.wA)(),{UBIFragment:G,spec:q,logger:K}=(0,w.r)(n.d,{data:{uri:T,reason:a.requestId||"",position:e}}),$=(0,k.t)(q),{isActive:Y,isPlaying:X,togglePlay:Q}=I({uri:T}),[J]=(0,C.S)(1e4,(e=>e?.item?.uri===T));(0,i.useEffect)((()=>{X&&(U.current=J)}),[X,J]),(0,i.useEffect)((()=>{!X&&U.current&&a.duration.milliseconds<=U.current&&M(!0)}),[X,a.duration.milliseconds]);const Z=(0,i.useCallback)((e=>{e||(U.current=0),M(e)}),[]),ee=E(t),te=(0,b.C)({...a,coverArt:{sources:a.coverArt}},ee),ae=(0,i.useCallback)((()=>{if(a.episodeType===S.I_.Episode&&_)m.h.set((()=>({triggerId:N(a.uri),triggerAction:null})));else if(z)te();else{let e;e=X?q.playButtonFactory().hitPause({itemToBePaused:T}):Y?q.playButtonFactory().hitResume({itemToBeResumed:T}):q.playButtonFactory().hitPlay({itemToBePlayed:T});const t=K.logInteraction(e);W({targetUri:T,intent:X?"pause":"play",type:"click"}),Q({loggingParams:t})}}),[Y,te,W,Q,T,X,z,a,_,K,q]),ie=(0,i.useCallback)((()=>{K.logInteraction(q.hitUiNavigate({destination:T})),W({type:"click",targetUri:T,intent:"navigate"})}),[T,W,K,q]),se=a.podcastSubscription?.isPaywalled??!1,ne=a.podcastSubscription?.isUserSubscribed??!1,re=se&&!ne,oe=se&&z,{badges:le}=(0,P.b)({contentRating:a.contentRating?.label,isPaywalled:se}),ce=(0,i.useCallback)((()=>H((0,o.Tf)(t.uri))),[t.uri,H]),de=(0,i.useCallback)((e=>{let i=e;return(re||oe)&&(i=(0,R.jsx)(p.N,{enabled:!0,showUri:a.podcast?.uri||t.uri,renderInline:!1,children:i})),!a.playability.playable&&le.nineteen&&(i=(0,R.jsx)("div",{onClick:e=>{e.stopPropagation(),ce()},children:e})),i=(0,R.jsx)(l.k,{id:N(T),targetURI:(0,r.o_h)(T),children:i}),i}),[T,re,oe,t.uri,le.nineteen,a.playability.playable,ce,a.podcast?.uri]);return(0,R.jsx)(G,{spec:q,children:(0,R.jsx)(j.pZ,{value:"row",index:e,children:(0,R.jsx)(c.h,{onShow:()=>{K.logInteraction(q.secondaryHitUiReveal())},menu:(0,R.jsx)(d.b,{uri:T,showUri:t.uri,sharingInfo:a.sharingInfo,isPlayed:D,onMarkAsPlayed:Z}),children:(0,R.jsx)(u.k,{ref:$,requestId:a.requestId,index:e,uri:T,size:V,images:a.coverArt||[],name:a.name,showName:a.podcast?.name||t.name,description:a.description,isPlayable:a.playability.playable||re,fullyPlayed:D,durationMs:a.duration.milliseconds,releaseDate:a.releaseDate?.isoString||"",resumePositionMs:U.current??F,draggable:L,handleDragStart:e=>{if(e.target!==e.currentTarget)return;const i=`${a.name} • ${t.name}`;O(e,{itemUris:[T],dragLabelText:i,contextUri:t.uri})},handlePlaybackClick:ae,handleClick:ie,isCurrentlyPlaying:Y,isPaywalled:se,isUserSubscribed:ne,isPlaying:X,position:X?J:void 0,episodeSharingInfo:a.sharingInfo,onMarkAsPlayed:Z,contentInformation:a.contentInformation,showUri:a.podcast?.uri||t.uri,mediaTypes:a.mediaTypes??void 0,badges:(0,R.jsx)(h.P,{episode:a}),playButtonWrapper:de,onMoreButtonClick:()=>{K.logInteraction(q.moreButtonFactory().hitUiReveal())},status:A,variant:B})})})})}))},43163:(e,t,a)=>{function i(e){const t=new Date;return(e instanceof Date?e:new Date(e)).getTime()-t.getTime()}a.d(t,{u:()=>i})},42462:(e,t,a)=>{a.d(t,{v:()=>r});var i=a(86565),s=a(50684);const n=new i.l("internalLinkRecommenderShow","query","6c369ff272a666b31fef1629c169925a1bd80f372195396c82304142cacd89e8",null),r=(e,t)=>(0,s.I)(n,e,t)},70030:(e,t,a)=>{a.d(t,{K:()=>i});const i=e=>{return t=e,"NotFound"!==t?.__typename&&"GenericError"!==t?.__typename&&"Podcast"===e.__typename;var t}},34482:(e,t,a)=>{a.d(t,{w:()=>d});var i=a(30758),s=a(58048),n=a(64721),r=a(72744),o=a(83439),l=a(11548),c=a(1620);const d=({uri:e,isBook:t})=>{const{add:a,remove:d}=(0,l.p)("prerelease"),u=(0,o.o)("prerelease",[e]).at(0),{enqueueSnackbar:m}=(0,r.d)(),{spec:p,logger:h}=(0,c.r)(s.k,{data:{uri:e}});return{isPreSaved:u,addPresave:(0,i.useCallback)((async()=>{h.logInteraction(p.actionBarFactory().preSaveButtonFactory().hitPresave({prereleaseId:e,itemToBePresaved:e,contextUri:e})),await a(e),m(t?n.Ru.get("web-player.prerelease.audiobook_feedback_presaved"):n.Ru.get("web-player.prerelease.album_feedback_presaved"))}),[a,m,t,h,p,e]),removePresave:(0,i.useCallback)((async()=>{h.logInteraction(p.actionBarFactory().preSaveButtonFactory().hitRemovePresave({prereleaseId:e,itemToBeRemovedFromPresaved:e,contextUri:e})),await d(e)}),[h,d,p,e])}}},52262:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Oi});var i=a(30758),s=a(1978),n=a(95589),r=a(54628),o=a(75627),l=a(64721),c=a(18212),d=a(9498),u=a(97500),m=a.n(u),p=a(95440),h=a(6128),g=a(63166),x=a(24772),y=a(58486),v=a(66686),b=a(38386),j=a(44979),f=a(74101),C=a(37769),k=a(68053),w=a(31793),S=a(55530),P=a(50178),R=a(71502),E=a(41861),N=a(2535),I=a(74511),A=a(95079),B=a(24902),_=a(30057);const F="Bns6t3CfzQaCA4DLRzPQ",T="zGFcpmwFVhJxRDXUXoXA",U="_FLyhB96W9W0msGYNWUl",D="Si5iVyGLDY7mGWH_U2wA",M="HLBtD6mJyIB9EeOzDtXE",L="DRO0ur1WXqpK9BelywtE",O="vtlBEOtYFwv1cxC32ccc",z="Pq_DZj9ECxwTsK8pBxe0",V="bu7LVUNyDPF_FcrKMv74",W="bYP2npsc_CeChpMGcr6g",H="Ux7aVnDYlwojS4AmkSLg";var G=a(86070);let q=function(e){return e.SMALL="small",e.LARGE="large",e}({});const K=({images:e,title:t,contentRating:a,duration:i,moreButton:s,onClick:n,onContextMenu:r,onTouchStart:o,onTouchEnd:l,isPlaying:c,isActive:d,size:u,className:p,label:h,isPlayable:g=!0})=>{const x=u===q.LARGE?"medium":"small",{badges:y}=(0,_.b)({contentRating:a});return(0,G.jsxs)("div",{"data-testid":"trailer-component",className:m()(F,p,{[T]:d}),onContextMenu:r,onTouchStart:o,onTouchEnd:l,children:[(0,G.jsxs)("div",{className:D,children:[(0,G.jsxs)("div",{className:z,children:[(0,G.jsx)(E.b,{type:B.c.EPISODE,title:t,className:m()(O,{[H]:u===q.SMALL,[W]:u===q.LARGE}),size:N.Qe.SIZE_56,images:e,shape:E.u.ROUNDED_CORNERS}),(0,G.jsx)("div",{className:V,children:(0,G.jsx)(S.R,{"data-testid":"trailer-play-button",version:w.H4.transparent,size:x,isPlaying:c,onClick:n,disabled:!g})})]}),(0,G.jsxs)("div",{children:[(0,G.jsx)("div",{className:M,children:(0,G.jsx)(k.Z,{dir:"auto",className:U,variant:"balladBold",children:t})}),(0,G.jsxs)("div",{className:L,children:[(0,G.jsx)(P.E,{text:h}),y.explicit&&(0,G.jsx)(R.U,{}),y.nineteen&&(0,G.jsx)(I.q,{}),(0,G.jsx)(k.Z,{dir:"auto",variant:"mesto",children:(0,G.jsx)(A.d,{durationMs:i})})]})]})]}),s]})};var $=a(99642),Y=a(89494),X=a(11716);const Q=({htmlDescription:e,narrators:t,spec:a,isPreRelease:s})=>{const n=(0,Y.W)(),r=(0,X.s)(),o=(0,i.useCallback)((e=>{n({intent:"expand-description",type:"click"});const t=a.seeMoreButtonFactory();r.logInteraction(e?t.hitUiReveal():t.hitUiHide())}),[r,n,a]);return(0,G.jsxs)(G.Fragment,{children:[t.length?(0,G.jsx)(h.E,{as:"p",variant:"bodyMedium",children:l.Ru.get("web-player.audiobooks.narratedByX",t.join(l.Ru.getSeparator()))}):null,e&&(0,G.jsx)($.N,{maxLines:4,content:e,htmlContent:e,onExpanded:o,isOpen:s||null})]})};var J=a(20673),Z=a(69319),ee=a(16683),te=a(66810),ae=a(52633),ie=a(49740),se=a(93336),ne=a(68056),re=a(76326),oe=a(14471),le=a(37659);const ce="myIGgR3zdb9nFuJ1pXYl",de="e74TmRHu_W1yZHspTBmR",ue="rrcjfInomKt1lXRDRdR8",me="Wj9mxFJDtPdiMcUtS1te",pe="SCwESjClY3m_9JlV2L7S",he="Yoa_yG2jhELT4w9wJpHf",ge="xsw253oiwmIAafVfjl1J",xe="JPqnsg5dgBTzsEoClLmD",ye="bhuRgaz03VXMf0mOG3Q2",ve="GP_qgmZlmL0CJ9r22AD9",be="bilV2VquzmEnhV4d97Tc",je="caqddwmUJf4ix6GI84NX",fe=({explicit:e,durationMs:t,publishDate:a,preReleaseEndDateTime:i,isPreRelease:s,uri:n,isPlaying:r})=>{const o=(0,oe.p)(n),{isMarkedAsFinished:c}=(0,re.z)(n);let d;return s&&i?d=l.Ru.get("web-player.prerelease.releases_on",{date:l.Ru.formatDate(i)}):!s&&a&&(d=l.Ru.formatDate(a)),(0,G.jsxs)("div",{className:ye,children:[e&&(0,G.jsx)(R.U,{className:je}),(0,G.jsxs)("div",{className:ve,children:[d&&(0,G.jsx)(h.E,{variant:"bodySmall",className:be,children:d}),t?(0,G.jsxs)(G.Fragment,{children:[o?.playPositionMilliseconds?(0,G.jsx)(h.E,{variant:"bodySmall",className:be,children:(0,G.jsx)(A.d,{durationMs:t})}):null,(0,G.jsx)(le.j,{isPlaying:r,fullyPlayed:c,durationMs:t,position:o?.playPositionMilliseconds})]}):null]})]})};var Ce=a(61214),ke=a(26851);const we=(0,i.createContext)(null),Se=({children:e,isPreRelease:t})=>{const[a,s]=(0,i.useState)(!t),n=(0,i.useMemo)((()=>({isPreRelease:t,isCountdownFinished:a,setCountdownFinished:()=>s(!0)})),[t,a,s]);return(0,G.jsx)(we.Provider,{value:n,children:e})};function Pe(){const e=(0,i.useContext)(we);if(null===e)throw new Error("Trying to use 'PreRealeaseCountdownContext' without 'PreRealeaseCountdownProvider'!");return e}var Re=a(11322);const Ee="nz8Wc80RAtdAb3yU9FxM",Ne=({uri:e})=>{const{isCountdownFinished:t}=Pe(),{invalidateCache:a}=(0,Re.W)(e);return(0,G.jsx)("div",{className:Ee,children:t?(0,G.jsx)(Ce.$,{onClick:a,children:l.Ru.get("web-player.audiobooks.goToAudiobook")}):(0,G.jsx)(ke.v,{uri:e,isBook:!0})})};var Ie=a(29294),Ae=a(40638),Be=a(72744),_e=a(65311),Fe=a(16964);const Te="NQAShVY0o7RQ2bCTDSkw";function Ue({uri:e,price:t,size:a,spec:i,logger:s,onPlayback:n}){const{enqueueSnackbar:r}=(0,Be.d)(),o=(0,_e.V)(),c=0===t?.finalPrice?.amount,d=c?i.getButtonFactory({uri:e}):i.buyButtonFactory({uri:e}),u=(0,Ae.YQ)((async()=>{if(s.logInteraction(d.hitShowPaywall({paywalledItem:e})),o)n();else{try{t?.finalPrice?await(0,Fe.S)({show_uri:e,currency:t.finalPrice.currency,price:t.finalPrice.amount}):r(l.Ru.get("error.generic"))}catch(e){r(l.Ru.get("error.generic"))}n()}}),2e3,{leading:!0,trailing:!1});return(0,G.jsx)(Ce.$,{size:a,className:Te,style:{flexShrink:0},onClick:u,children:c?l.Ru.get("web-player.audiobooks.buyFree"):l.Ru.get("web-player.audiobooks.buy")})}const De=({uri:e,isLocked:t,price:a,isPlaying:i,isConsumptionCapped:s,onPlayback:n,logger:r,spec:o,size:l="large"})=>t&&!s?(0,G.jsx)(Ue,{size:l,uri:e,price:a,logger:r,spec:o,onPlayback:n}):(0,G.jsx)(Ie.D,{size:l,isPlaying:i,uri:e,onClick:n});var Me=a(39521),Le=a(49811),Oe=a(83989),ze=a(49066),Ve=a(56106),We=a(1620);const He="8px",Ge=i.memo((function({backgroundColor:e,uri:t,name:a,isPlaying:s,togglePlay:n,isLocked:r,isSaved:o,consumptionCapExplanation:c,price:d,spec:u,isExplicit:m,publishDate:h,preReleaseEndDateTime:g,duration:x}){const[y,b]=(0,ze.A)(t,o),f=!(0,Oe.n)(),{isPreRelease:C}=Pe(),k=(0,p.wA)(),w=(0,Y.W)(),S=(0,X.s)(),P=(0,Me.d$)(),{spec:R,logger:E}=(0,We.r)(J.e,{data:{uri:t}});(0,i.useEffect)((()=>{P&&E.logImpression(R.impression())}),[P,E,R]);const N=(0,i.useCallback)((()=>{w({targetUri:t,intent:y?"unsave":"save",type:"click"});const e=u.saveToLibraryButtonFactory();y?S.logInteraction(e.hitUnfollow({itemToBeUnfollowed:t})):(S.logInteraction(e.hitFollow({itemToBeFollowed:t})),P&&E.logInteraction(R.hitFollow({itemToBeFollowed:t}))),b(!y)}),[w,t,y,u,b,S,P,E,R]),I=(0,i.useCallback)(((e,a)=>{const i=u.downloadButtonFactory();c?k((0,v._3)(c)):a===Ve.NV.ADD?S.logInteraction(i.hitDownload({itemToDownload:t})):a===Ve.NV.REMOVE?S.logInteraction(i.hitRemoveDownload({itemToRemoveFromDownloads:t})):a===Ve.NV.NO_PERMISSION&&S.logInteraction(i.hitUiReveal())}),[c,k,S,u,t]),A=(0,i.useCallback)((()=>{const e=u.contextButtonFactory().hitUiReveal();S.logInteraction(e)}),[S,u]),B=(0,Le.j)(),_=!!c,F=!r&&!_;return(0,G.jsxs)(Z.E,{backgroundColor:e,style:{"--action-bar-padding-bottom":He},children:[(0,G.jsx)(ee.S,{testId:"book-action-bar-metadata",children:(0,G.jsx)(fe,{explicit:m,publishDate:h,preReleaseEndDateTime:g,durationMs:x,isPreRelease:C,uri:t,isPlaying:s})}),(0,G.jsxs)(ee.S,{children:[C&&(0,G.jsx)(Ne,{uri:t}),!C&&(0,G.jsx)(De,{uri:t,isLocked:r,isConsumptionCapped:_,price:d,isPlaying:s,onPlayback:n,logger:S,spec:u,size:B}),!C&&(0,G.jsx)(ne.e,{children:(0,G.jsx)(te.M,{isAdded:y,onClick:N,disabled:f,size:B,isAudiobook:!0,condensed:!0})},"follow-button"),(0,G.jsx)(ae.I,{uri:t,onClick:I,size:B,canDownload:F}),(0,G.jsx)(j.b,{menu:(0,G.jsx)(se.p,{uri:t,isPreRelease:C}),children:(0,G.jsx)(ie.e,{label:l.Ru.get("more.label.context",a),onClick:A,size:B})})]})]})}));var qe=a(13377),Ke=a(15783),$e=a(67674),Ye=a(87244),Xe=a(76418),Qe=a(29080),Je=a(7777),Ze=a(98991),et=a(65866),tt=a(43233),at=a(22640),it=a(17067),st=a(90861),nt=a(90089);const rt="BBK_i9SHovXTLVjas0kc",ot=i.memo((function({coverArt:e,name:t,authorName:a,uri:i,backgroundColor:s,isPlaying:n,togglePlay:r,isLocked:o,price:c,isConsumptionCapped:d,logger:u,spec:m,preReleaseEndDateTime:p}){const g=(0,nt.y)(),x=g===st.E.SMALL||g===st.E.XSMALL,{isPreRelease:y,setCountdownFinished:v}=Pe(),b=y&&x,j=(0,G.jsx)(se.p,{uri:i});return(0,G.jsxs)(Ye.z,{backgroundColor:s,size:y?Ye.K.XLARGE:Ye.K.DEFAULT,children:[(0,G.jsxs)(Je.h,{children:[y&&(0,G.jsx)(Ne,{uri:i}),!y&&(0,G.jsx)(De,{uri:i,isLocked:o,price:c,isPlaying:n,isConsumptionCapped:d,onPlayback:r,logger:u,spec:m,size:"medium"}),(0,G.jsx)(qe.h,{menu:j,children:(0,G.jsx)(Ze.X,{text:t,dragUri:i,dragLabel:t})})]}),!b&&(0,G.jsx)(qe.h,{menu:j,children:(0,G.jsx)(Xe.K,{images:e,name:t,dragUri:i,dragMimeType:$e.fl.AUDIOBOOKS,shape:E.u.SQUARE})}),(0,G.jsxs)(Qe.Y,{children:[(0,G.jsx)(tt.B,{children:l.Ru.get("web-player.audiobooks.audiobook")}),(0,G.jsx)(qe.h,{menu:j,children:(0,G.jsx)(it.mm,{canEdit:!1,onClick:()=>{},scaleAtMinWidth:it.tw,dragUri:i,dragMimeType:$e.fl.AUDIOBOOKS,dragLabel:t,children:t})}),y?(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(et.X,{children:(0,G.jsx)(h.E,{className:rt,variant:"bodySmallBold","data-testid":"entityAuthor",children:a})}),p&&(0,G.jsx)(Ke.G,{targetDate:p,images:b?e:[],imageTitle:t,onComplete:v})]}):(0,G.jsx)(at.g,{children:a})]})]})})),lt="pwjwUMaZVoJ0wBcQlIDf",ct=i.memo((({price:e})=>e.finalPrice&&e.finalListPrice?0===e.finalPrice.amount&&0===e.finalListPrice.amount?(0,G.jsxs)("div",{className:lt,children:[(0,G.jsx)(h.E,{variant:"bodyMediumBold",semanticColor:"textBase",children:l.Ru.get("audiobook.freePriceDescription")}),(0,G.jsx)(h.E,{variant:"bodySmall",children:l.Ru.get("audiobook.freePriceExplanation")})]}):(0,G.jsxs)("div",{className:lt,children:[(0,G.jsx)(h.E,{variant:"titleSmall",semanticColor:"textBase",children:e.finalPrice.formattedPrice}),e.finalPrice.amount<e.finalListPrice.amount&&(0,G.jsx)(h.E,{variant:"bodyMedium",semanticColor:"textSubdued",children:l.Ru.get("web-player.audiobooks.retailPrice",(0,G.jsx)("span",{style:{textDecoration:"line-through"},children:e.finalListPrice.formattedPrice}))})]}):null));var dt=a(65583),ut=a(96930),mt=a(25336),pt=a(19412),ht=a(84014),gt=a(60001);const xt="XzRW0BrBLoXKWET5f8m4",yt="ooqITYCPJKua4e5yv8_9",vt="zN8lTnSnAUSRAMPb7XYV",bt="llVyicNXe8z0QAnoRur1",jt="fCrjgF2UgDUWjtqWls4Q",ft="CLnKy_BRVtIluLfBWy5t",Ct="RZa0qnXymlZCoGOdE03d",kt="RFXE57hUzWvvK4_7GX13",wt="ALQqkJiR2lZOSYvhHesh",St="BQwrI2BbKK4n451iu2QC",Pt="VYLq_YaQVNISHPQOu2af",Rt=i.memo((function({name:e,duration:t,uri:a,bookName:s,usePlayContextItem:n,isChapterLocked:r,isPlayable:o,resumePositionMs:c,isFullyPlayed:d,isExplicit:u,is19PlusOnly:x,spec:y,index:C,consumptionCapExplanation:k}){const w=(0,i.useRef)(c),{isPlaying:P,togglePlay:E,isActive:N}=n({uri:a}),B=(0,X.s)(),_=(0,_e.V)(),F=(0,p.wA)(),T=(0,g.NC)(pt.HEU,{loadingValue:!1}),U=(0,ht.o)((e=>{if(e?.item?.uri===a){const t=(0,gt.s)(e)??0;return w.current=t,t}return 0})),D=(0,i.useCallback)((e=>{e.stopPropagation(),e.preventDefault()}),[]),M=(0,Y.W)(),L=(0,i.useCallback)((e=>{if(D(e),k&&!_&&T)return void F((0,v._3)(k));const t=y.chapterBlockFactory({position:C,uri:a}).playButtonFactory();if(r)M({type:"click",intent:"audiobook-gated-entry-point",itemIdSuffix:"target-chapter"}),B.logInteraction(t.hitShowPaywall({paywalledItem:a}));else{const e=(0,mt.$I)({isPlaying:P,isActive:N,spec:t,logger:B,uri:a});E({loggingParams:e})}}),[k,F,C,T,N,_,r,P,B,M,y,D,E,a]),O=(0,i.useCallback)((()=>{const e=y.chapterBlockFactory({position:C,uri:a}).secondaryHitUiReveal();B.logInteraction(e)}),[C,B,y,a]),z=(0,i.useCallback)((e=>{D(e);const t=y.chapterBlockFactory({position:C,uri:a}).contextMenuFactory().hitUiReveal();B.logInteraction(t)}),[C,B,y,D,a]),V=!(r||k),W=(0,G.jsx)(dt.d,{className:m()({[yt]:N}),children:e}),H=(0,G.jsxs)("div",{className:ft,children:[u&&(0,G.jsx)(R.U,{fullText:!0}),x&&(0,G.jsx)(I.q,{size:16}),(0,G.jsxs)("div",{className:Ct,children:[w.current?(0,G.jsx)(h.E,{variant:"bodySmall",className:Pt,children:(0,G.jsx)(A.d,{durationMs:t.milliseconds})}):null,(0,G.jsx)(le.j,{isPlaying:P,fullyPlayed:d,durationMs:t.milliseconds,resumePositionMs:w.current,position:P?U:void 0})]})]}),q=(0,G.jsxs)("div",{className:wt,children:[(0,G.jsx)("div",{className:St,children:V?(0,G.jsx)(j.b,{menu:(0,G.jsx)(f.r,{uri:a}),children:(0,G.jsx)(b.e,{className:jt,size:b.M.xs,label:l.Ru.get("more.label.context",e),onClick:z})}):null}),(0,G.jsx)("div",{className:kt,children:(0,G.jsx)(S.R,{size:"small",version:S.H.secondary,onClick:L,isPlaying:P,ariaPlayLabel:l.Ru.get("tracklist.a11y.play",e,s),ariaPauseLabel:l.Ru.get("tracklist.a11y.pause",e,s),locked:r&&!k,disabled:!o&&!(r||k)})})]}),K=(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)("hr",{className:vt,"aria-hidden":!0}),(0,G.jsx)(ut.v,{id:`chapter-${C}`,title:W,body:H,footer:q,onDoubleClick:e=>{M({targetUri:a,intent:"play",type:"double-click"}),L(e)},className:xt})]});return V?(0,G.jsx)(qe.h,{menu:(0,G.jsx)(f.r,{uri:a}),onShow:O,children:(0,G.jsx)("div",{className:bt,children:K})}):(0,G.jsx)("div",{className:bt,children:K})}));var Et=a(7038),Nt=a(42911);var It=a(99916);const At=({bookUri:e,bookName:t,sampleUri:a,isFinishedUnlockingJourney:s,usePlayContextItem:n,spec:r,consumptionCapExplanation:o})=>{const l=function(e,t){const a=(0,Nt.T)();return(0,i.useCallback)((async(i,s)=>a.getBookContents(e,{offset:i,limit:s,doRefreshSubscription:t})),[t,a,e])}(e,s),c=(0,i.useRef)(!1),d=(0,i.useRef)(0),{isMarkedAsFinished:u}=(0,re.z)(e),[m,p]=(0,i.useState)([]),h=(0,i.useCallback)((e=>e?.uri===a),[a]),g=(0,i.useCallback)((e=>(e=>null!==e)(e)&&!h(e)),[h]),x=(0,i.useCallback)((()=>{l&&(c.current||null===d.current||(c.current=!0,l(d.current,50).then((e=>{c.current=!1,d.current=e.nextOffset,e.items.length>0&&p((t=>t.concat(e.items.filter(g))))}))))}),[l,g]);return(0,i.useEffect)((()=>{d.current=0,p([])}),[e]),(0,G.jsx)("ul",{children:(0,G.jsx)(Et._,{onReachBottom:x,triggerOnInitialLoad:!0,children:m.map(((e,a)=>{const{name:i,duration:s,uri:l,playability:{playable:c},playedState:{playPositionMilliseconds:d,state:m},isExplicit:p,is19PlusOnly:h}=e,g=m===It._w.Completed||u,x=function(e){return!e.playability?.playable&&(e.playability?.reason===It.Uk.PaymentRequired||e.playability?.reason===It.Uk.Anonymous)}(e);return(0,G.jsx)(Rt,{name:i,duration:s,uri:l,bookName:t,usePlayContextItem:n,isPlayable:c,isChapterLocked:x,consumptionCapExplanation:o,resumePositionMs:d,isFullyPlayed:g,isExplicit:p,is19PlusOnly:h,spec:r,index:a},l)}))})})};var Bt=a(72277),_t=a(55624),Ft=a(41603),Tt=a(96664),Ut=a(22389);const Dt="_yl4tOZxcpoUt28k6B8I",Mt="lcJflizNrSwDM9yPNk6h",Lt="ret7iHkCxcJvsZU14oPY",Ot=({rating:e,className:t,onClick:a})=>{if(!e)return null;const i=Boolean(e.rating?.rating);return(0,G.jsxs)("button",{className:m()(Dt,t),onClick:a,children:[(0,G.jsx)(k.Z,{dir:"auto",variant:"mestoBold",children:e.averageRating?.showAverage?l.Ru.formatNumber(e.averageRating.average,{maximumFractionDigits:1}):l.Ru.get("web-player.audiobooks.noRating")}),i?(0,G.jsx)(Tt.j,{iconSize:16,className:m()(Mt)}):(0,G.jsx)(Ut.a,{iconSize:16,className:m()(Mt)}),e.averageRating?.showAverage&&(0,G.jsxs)(k.Z,{variant:"mesto",className:m()(Lt),children:["(",l.Ru.formatNumberCompact(Number(e.averageRating.totalRatings)),")"]})]})};var zt=a(35175),Vt=a(88417),Wt=a(84058),Ht=a(84817);const Gt={shuffle:!1,repeat:Wt.p.REPEAT_NONE},qt=i.memo((function({metadata:e}){const{uri:t,coverArt:a,name:n,htmlDescriptionPlain:o,authorName:d,sample:u,narrators:k,rating:w,isExplicit:S,duration:P,copyrights:R,publishDate:E,price:N,isLocked:I,isSaved:A,consumptionCapExplanation:_,signifierText:F,resumeEpisodeLink:T,topics:U,isPreRelease:D,preReleaseEndDateTime:M}=e,{search:L}=(0,s.zy)(),O=!!new URLSearchParams(L).get("isUnlockingAudiobook"),z=!(!(0,zt.Z)(O)||O),V=(0,_e.V)(),W=(0,_t.H)(a[0]?.url),H=(0,p.wA)(),$=(0,Y.W)(),X=(0,g.NC)(pt.HEU,{loadingValue:!1}),{spec:J,logger:Z}=(0,We.r)(x.U,{data:{uri:t,identifier:r.$h.PODCAST_SHOW_AUDIOBOOK}}),{spec:ee,logger:te}=(0,We.r)(x.U,{data:{uri:t,identifier:r.$h.RATINGS_AND_REVIEWS_RATINGS_AUDIOBOOK}}),{spec:ae,logger:ie}=(0,We.r)(y.Y,{data:{uri:t,identifier:r.$h.PODCAST_SHOW_AUDIOBOOK}}),se=(0,i.useMemo)((()=>J.actionBarFactory()),[J]),ne=(0,i.useMemo)((()=>ee.aboutSectionFactory()),[ee]),re=(0,i.useMemo)((()=>J.chapterListFactory()),[J]);(0,i.useEffect)((()=>{$({type:"view",intent:"audiobook"})}),[$]),(0,i.useEffect)((()=>{I&&ie.logImpression(ae.impression())}),[ae,ie,I]);const{isPlaying:oe,togglePlay:le,usePlayContextItem:ye,isActive:ve,triggerPlay:be}=(0,Vt.P)({uri:t},{featureIdentifier:"audiobook"},Gt),{togglePlay:je,isPlaying:fe,isActive:Ce}=(0,Vt.P)({uri:u?.uri??"",pages:[{items:[{uri:u?.uri??"",uid:u?.uri??"",type:B.c.CHAPTER,provider:null,metadata:D?{is_pre_release:"true",type:"trailer"}:void 0}]}]},{featureIdentifier:"audiobook"},Gt),ke=oe&&!fe,we=ve&&!Ce,Pe=(0,i.useCallback)((async()=>{const e=J.actionBarFactory().playButtonFactory();if(_&&!V&&X)return Z.logInteraction(e.hitShowPaywall({paywalledItem:t})),void H((0,v._3)(_));if(!I||V)if(V)le();else{const a=(0,mt.$I)({isPlaying:ke,isActive:we,spec:e,logger:Z,uri:t});we?le({loggingParams:a}):be({skipTo:T?{uri:T}:void 0,loggingParams:a})}}),[J,_,V,X,I,Z,t,H,le,ke,we,be,T]),Re=(0,i.useCallback)((()=>{u?.uri&&($({targetUri:u.uri,intent:fe?"play":"pause",type:"click"}),je())}),[fe,$,je,u?.uri]),Ee=(0,i.useCallback)((()=>{const a=ne.ratingButtonFactory().hitUiReveal();te.logInteraction(a),H((0,v.eH)(t,e))}),[ne,H,e,te,t]),Ne=(0,nt.y)(),Ie=I&&!_&&N;return(0,G.jsx)("section",{className:ce,children:(0,G.jsxs)(Se,{isPreRelease:D,children:[(0,G.jsx)(c.Q,{children:(0,Ht.hV)({showOrAudiobookName:n,type:"Audiobook"})}),(0,G.jsx)(Bt.c,{artistOrShow:d,title:n,uri:t,entityType:Bt.p.AUDIOBOOK}),(0,G.jsx)(ot,{name:n,authorName:d,uri:t,coverArt:a,backgroundColor:W,togglePlay:Pe,isPlaying:ke,isLocked:I,isConsumptionCapped:!!_,price:N,logger:Z,spec:J.actionBarFactory(),preReleaseEndDateTime:M}),(0,G.jsx)(Ge,{name:n,backgroundColor:W,uri:t,togglePlay:Pe,isPlaying:ke,isLocked:I,isSaved:A,consumptionCapExplanation:_,isExplicit:S,duration:P,publishDate:E,preReleaseEndDateTime:M,price:N,spec:se}),(0,G.jsxs)("div",{className:m()(de,"contentSpacing",{[ue]:Ne===st.E.LARGE}),children:[(0,G.jsxs)("div",{className:me,children:[(0,G.jsxs)("div",{className:xe,children:[F&&(0,G.jsx)(h.E,{variant:"bodyMedium",as:"p",semanticColor:"textBrightAccent",children:F}),!F&&Ie&&(0,G.jsx)(ct,{price:N})]}),(0,G.jsx)(Q,{htmlDescription:o,narrators:k,spec:ne,isPreRelease:D??!1})]}),(0,G.jsxs)("div",{className:pe,children:[u?.isPlayable&&(0,G.jsx)(K,{label:l.Ru.get("audiobook.page.sample"),images:u.coverArt,title:u.name,duration:u.duration.milliseconds,moreButton:I?null:(0,G.jsx)(j.b,{menu:(0,G.jsx)(f.r,{uri:u.uri}),children:(0,G.jsx)(b.e,{})}),onClick:Re,isPlaying:fe,isActive:Ce,size:q.LARGE,contentRating:u.contentRating?.label,isPlayable:u.isPlayable}),!D&&(0,G.jsx)("div",{className:he,children:(0,G.jsx)(Ot,{rating:w,onClick:Ee})}),U.length>0&&(0,G.jsx)(C.N,{topics:U})]}),(0,G.jsxs)("div",{className:ge,children:[!D&&(0,G.jsx)(At,{bookUri:t,bookName:n,sampleUri:u?.uri,isFinishedUnlockingJourney:z,usePlayContextItem:ye,spec:re,consumptionCapExplanation:_},`${t}-${I}-${!!_}`),(0,G.jsx)(Ft.Z,{copyrights:R})]})]})]})})}));var Kt=a(27317),$t=a(1467),Yt=a(92295);const Xt=({uri:e,name:t,isSaved:a,backgroundColor:s,spec:n})=>{const r=(0,X.s)(),o=(0,Y.W)(),c=!(0,Oe.n)(),[d,u]=(0,ze.A)(e,a),m=(0,Me.d$)(),{spec:p,logger:h}=(0,We.r)(J.e,{data:{uri:e}});(0,i.useEffect)((()=>{m&&h.logImpression(p.impression())}),[m,h,p]);const g=(0,i.useCallback)((()=>{o({targetUri:e,intent:d?"unsave":"save",type:"click"});const t=n.followButtonFactory();r.logInteraction(d?t.hitUnfollow({itemToBeUnfollowed:e}):t.hitFollow({itemToBeFollowed:e})),!d&&m&&h.logInteraction(p.hitFollow({itemToBeFollowed:e})),u(!d)}),[o,e,d,n,r,u,m,h,p]),x=(0,i.useCallback)((()=>{r.logInteraction(n.contextButtonFactory().hitUiReveal())}),[r,n]),y=(0,Le.j)();return(0,G.jsx)(Z.E,{backgroundColor:s,children:(0,G.jsxs)(ee.S,{children:[(0,G.jsx)(ne.e,{children:(0,G.jsx)(Yt.W,{isFollowing:d,onClick:g,disabled:c})},"follow-button"),(0,G.jsx)(j.b,{menu:(0,G.jsx)($t.H,{uri:e}),onShow:x,children:(0,G.jsx)(ie.e,{label:l.Ru.get("more.label.context",t),size:y})})]})})};var Qt=a(14761),Jt=a(17934),Zt=a(99912),ea=a(93395),ta=a(31761),aa=a(23112),ia=a(96009),sa=a(55285),na=a(84576);const ra="BknvXMyUnN3fQCz8mvLI",oa="slMInsl3HL9_02zHT22R",la="40px",ca=({leavebehinds:e})=>{let t;return 1===e.length&&(t=(0,G.jsx)(h.E,{variant:"bodySmallBold",semanticColor:"textBase",children:e[0].advertiser})),2===e.length&&(t=l.Ru.get("podcast-ads.recent_ads_just_two",(0,G.jsx)(h.E,{variant:"bodySmallBold",semanticColor:"textBase",children:e[0].advertiser}),(0,G.jsx)(h.E,{variant:"bodySmallBold",semanticColor:"textBase",children:e[1].advertiser}))),e.length>2&&(t=l.Ru.get("podcast-ads.recent_ads_more_than_two",(0,G.jsx)(h.E,{variant:"bodySmallBold",semanticColor:"textBase",children:e[0].advertiser}),(0,G.jsx)(h.E,{variant:"bodySmallBold",semanticColor:"textBase",children:e[1].advertiser}))),(0,G.jsxs)(h.E,{variant:"bodySmall",semanticColor:"textSubdued","data-testid":"show-leavebehinds-text",children:[l.Ru.get("podcast-ads.recent_ads_from"),t]})},da=({leavebehinds:e,uri:t,surface:a})=>{const s=(0,na.vh)();if((0,i.useEffect)((()=>{t&&e.length>0&&s.send((0,ea.x)({leavebehind_request_id:e[0].requestId,event:"event_viewed",event_reason:`viewed_on_${(0,ta.Fh)(a).toLowerCase()}`,surface:(0,ta.Fh)(a),uri:t}))}),[s,e,t,a]),0===e.length)return null;const n=(0,o.o_h)(t)?.id,r=1===e.length?e[0].clickthroughUrl:(0,aa.q)(n),c=ia.Qd,d=e.length>c,u=e.length-(c-1),m=e.slice(0,d?c-1:c);return(0,G.jsx)(sa.N,{to:r,pathname:e.length>1?r:void 0,state:{uri:t},className:oa,onClick:()=>s.send((0,ea.x)({leavebehind_request_id:e[0].requestId,event:"event_clicked",event_reason:"cta_see_all",surface:(0,ta.Fh)(a),uri:t})),"data-testid":"show-leavebehinds-container",children:(0,G.jsx)(ut.v,{layout:"wide",variant:"tinted",size:"xl",id:"show-leavebehinds",title:(0,G.jsxs)("div",{className:ra,"data-testid":"show-leavebehinds-logos-container",children:[m.map((e=>(0,G.jsx)(Jt.C,{"data-testid":"show-leavebehind-image",src:e.displayImage.src,alt:e.displayImage.alt,imageHeight:la,imageWidth:la},e.adId))),d?(0,G.jsx)(ua,{"data-testid":"show-leavebehinds-more-count-indicator",variant:"tinted",minBlockSize:la,borderRadius:"4px",padding:"6px",children:(0,G.jsx)(h.E,{variant:"bodyMedium","data-testid":"show-leavebehinds-more-count-indicator-text",children:l.Ru.get("podcast-ads.show_more_indicator",u)})}):null]}),body:(0,G.jsx)(ca,{leavebehinds:e})})})};var ua=(0,Qt.Ay)(Zt.a).withConfig({displayName:"LeavebehindsPreview___StyledBox",componentId:"sc-qakd80-0"})({backgroundColor:"#121212",width:"40px",display:"flex",alignItems:"center",justifyContent:"center"}),ma=a(34221);const pa=ta.ui.SHOW_PAGE;function ha({uri:e}){const{data:t,error:a,getLeavebehinds:s}=(0,ma.A)({surface:pa,uri:e});(0,i.useEffect)((()=>{s()}),[s]);const n=(0,i.useMemo)((()=>t?(0,ia.iT)(t,e):[]),[t?.requestId]);return a||t?.leavebehindAds&&t?.leavebehindAds?.length<1?null:(0,G.jsx)(da,{leavebehinds:n,uri:e,surface:pa})}var ga=a(48732),xa=a(74410),ya=a(16127),va=a(28534),ba=a(16249),ja=a(42462),fa=a(43431),Ca=a(70030),ka=a(81799),wa=a(30706);const Sa=({className:e,title:t,uri:a})=>{const{data:i}=(0,ja.v)({uri:a}),s=i?.seoRecommendedPodcast.totalCount,n=i?.seoRecommendedPodcast.items,r=function(e){return(e||[]).filter((e=>(0,Ca.K)(e.data)))}(n);if(0===s)return null;const c=(0,o.o_h)(a)?.id;return(0,G.jsx)(ka.$,{className:e,title:t,seeAllLabel:l.Ru.get("shelf.see-all"),total:s,alwaysShowSeeAll:!0,seeAllUri:`spotify:app:show:${c}:more-like-this`,children:r?.map((({data:e},t)=>(0,G.jsx)(va.o,{uri:e.uri,name:e.name,images:e.coverArt?.sources||[],publisher:e.publisher?.name??"",sharingInfo:null,mediaType:(0,wa.w)(e.mediaType),index:t},e.uri)))})},Pa=e=>{const t=(0,fa.D)({entityType:B.c.SHOW,componentType:"shelf",uri:e.uri});return(0,G.jsx)(ba.s,{onError:t,children:(0,G.jsx)(Sa,{...e})})};var Ra=a(7041),Ea=a(8549),Na=a(96613),Ia=a(27796),Aa=a(35844);const Ba=(0,i.createContext)({setSortState:()=>{throw new Error("setSortState must be used within a ShowFilterProvider")},sortState:[]}),_a=i.memo((function({uri:e,children:t}){return(0,G.jsx)(Aa.E,{uri:e,defaultState:[],sortContext:Ba,localStorageKey:"showFilterParams-v2",children:t})}));var Fa=a(22686);const Ta={field:Fa.WY.PUBLISH_DATE,order:Fa.AX.DESC},Ua={field:Fa.WY.PUBLISH_DATE,order:Fa.AX.ASC},Da=Ua,Ma={episodic:Ta,sequential:Ua,recent:Ta};function La(){return new Map([[Ta,{key:"newest-to-oldest",value:l.Ru.get("shows.sort.newest-to-oldest")}],[Ua,{key:"oldest-to-newest",value:l.Ru.get("shows.sort.oldest-to-newest")}]])}function Oa(e){return Ma[e]}const za=(0,i.createContext)({setSortState:()=>{throw new Error("setSortState must be used within a ShowSortProvider")},sortState:Oa("recent")}),Va=e=>{const t=La();return Array.from(t.keys()).some((({field:t})=>t===e?.field))},Wa=i.memo((function({uri:e,children:t,defaultSortParam:a}){return(0,G.jsx)(Aa.E,{uri:e,defaultState:a,sortContext:za,localStorageKey:"showSortParam",validator:Va,children:t})}));var Ha=a(1817),Ga=a(95309),qa=a(88308);const Ka="ysJC093hc_2ixGCy40_s",$a="mJP3Bamg3hN7S0p7XKfN",Ya="clPqCj1L_KSfoVuTuP6x",Xa="vqQmhCMZq7eUtTV7YYOQ",Qa={totalCount:0,nextOffset:0,items:[]},Ja=i.memo((function({showMetadata:e,usePlayContextItem:t}){const{sortState:a}=(0,i.useContext)(za),{sortState:s}=(0,i.useContext)(Ba),n=function(e,t,a){const i=(0,Nt.T)(),{canSort:s}=i.capabilities,n=(0,qa.U0)((async(s,n)=>i.getContents(e,{offset:s,limit:n,sort:t,filters:a})),[i,e,t,a]),r=(0,qa.U0)((async(t,a)=>i.getContents(e,{offset:t,limit:a})),[i,e]);return s?n:r}(e.uri,a,s),[r,o]=(0,i.useState)(Qa),c=(0,i.useRef)(!1),d=(0,i.useRef)(0),u=(0,Ha.c)(),m=u?6:50,p=u&&null!==d.current,g=(0,i.useCallback)(((e=!1)=>{if(!n)return;const t=d.current;null!==t&&!c.current&&m>0&&(c.current=!0,n(t,m).then((a=>{o((i=>{const s=e?[]:[...i.items];return s.splice(t,a.items.length,...a.items),d.current=a.nextOffset,{...a,items:s}})),c.current=!1})))}),[n,m]);return(0,i.useEffect)((()=>{o(Qa)}),[e.uri]),(0,i.useEffect)((()=>{d.current=0,g(!0)}),[g]),(0,G.jsxs)(Ga.pZ,{value:"track-list",children:[(0,G.jsx)(Et._,{onReachBottom:u?void 0:g,triggerOnInitialLoad:!0,children:r.items.map(((a,i)=>a&&(0,G.jsxs)("div",{className:$a,children:[(0,G.jsx)("hr",{className:Ka,"aria-hidden":!0}),(0,G.jsx)(Ea.q,{index:i,episode:a,showMetadata:e,usePlayContextItem:t},`${a.uri}/${i}`)]},`${i}${a.uri}`)))}),p&&(0,G.jsx)("div",{className:Ya,children:(0,G.jsxs)(Na.v,{onClick:()=>{g()},className:Xa,children:[(0,G.jsx)(h.E,{variant:"bodySmallBold",children:l.Ru.get("internal-link-recommender.load-more-episodes")}),(0,G.jsx)(Ia.V,{size:"xsmall"})]})})]})}));var Za=a(1335);const ei={field:Fa.K$.ISPLAYED,operator:Fa.uj.EQUALS,value:!1},ti={field:Fa.K$.STARTEDPLAYING,operator:Fa.uj.GREATER_THAN,value:0};const ai="all-episodes",ii=({onFilter:e})=>{const{sortState:t,setSortState:a}=(0,i.useContext)(Ba),s=new Map([[ei,{key:"is-played",value:l.Ru.get("shows.filter.unplayed")}],[ti,{key:"started-playing",value:l.Ru.get("shows.filter.in-progress")}]]),n=Array.from(s.values());n.unshift({key:ai,value:l.Ru.get("mwp.podcast.all.episodes")});const r=Array.from(s.keys()),o=(0,i.useCallback)((t=>{if(t===ai)a([]);else{const e=r.find((e=>s.get(e)?.key===t));e&&a([e])}e()}),[e,a,r,s]);if(!s.size||!r)return null;let c=n[0];const d=Array.from(s.entries()).filter((e=>t?.some((t=>t.field===e[0].field&&t.operator===e[0].operator))));return d.length>0&&(c=d[0][1]),(0,G.jsx)(Za.g,{options:n,onSelect:e=>o(e),selected:c,variant:"bodyMediumBold",semanticColor:"textBase",heading:l.Ru.get("drop_down.filter_by")})},si=({onSort:e})=>{const{sortState:t,setSortState:a}=(0,i.useContext)(za),s=La(),n=Array.from(s.values()),r=Array.from(s.keys()),o=(0,i.useCallback)((t=>{const i=r.find((e=>s.get(e)?.key===t));i&&a(i),e()}),[r,e,s,a]);if(!s.size||!t)return null;const c=Array.from(s.keys()).find((e=>e.field===t.field&&e.order===t.order));if(!c)return null;const d=s.get(c);return d?(0,G.jsx)(Za.g,{options:n,onSelect:e=>o(e),selected:d,heading:l.Ru.get("drop_down.sort_by")}):null},ni="bOAvdKi0zqyA_S6ThcvF",ri="jVWq1orbpiIK34UFHkFb",oi="gYTsg8kvcGmu41_lilIb",li="GMHh7OED_Nijo4zzSfrb",ci="sNEwCEh44Lapg36PnVFw",di="SoIsw3P_1RnUtFBHs_2d",ui="OMG3QMzpwer8oWsiJpzs",mi="r0yVSge7A1iSTNfudfyV",pi="yP6EeRtQJeqKq10IsMxn",hi="MIaGJ1KyQ3JLblOjWL19",gi="p8WHC1qBUrwrBwzp_vYY",xi="Uzyuaxpkm_Gwb6jOGbva",yi="TSNj_F4gGzCuxrzx6n98",vi="E4HX0M3aD0MY5dUCKSCb",bi="CbSqM7wDwoLFnyIo1iKL",ji="c0h80mSMc3PkNlHX0DYs",fi="SGGetEMTKgQk1aJvG4k9",Ci="ne3ntrWAoMrE6_4A23Mf",ki=({spec:e})=>{const t=(0,X.s)(),{canSort:a,canFilter:s}=(0,Nt.T)().capabilities,n=(0,i.useCallback)((()=>{t.logInteraction(e.episodeListFactory().filterButtonFactory().hitFilter())}),[t,e]),r=(0,i.useCallback)((()=>{t.logInteraction(e.episodeListFactory().sortButtonFactory().hitSort())}),[t,e]);return(0,G.jsxs)("div",{className:pi,children:[s&&(0,G.jsx)("div",{className:gi,children:(0,G.jsx)(ii,{onFilter:n})}),!s&&(0,G.jsx)(h.E,{as:"h3",variant:"titleSmall",semanticColor:"textBase",className:xi,children:l.Ru.get("mwp.podcast.all.episodes")}),a&&(0,G.jsx)("div",{className:hi,children:(0,G.jsx)(si,{onSort:r})})]})};var wi=a(61155),Si=a(20520),Pi=a(18032),Ri=a(63112);const Ei=e=>{switch(e){case It.t5.TRAILER:return l.Ru.get("podcasts.next-episode.trailer");case It.t5.UP_NEXT:return l.Ru.get("podcasts.next-episode.up-next");case It.t5.CONTINUE_LISTENING:return l.Ru.get("podcasts.next-episode.continue-listening");case It.t5.FIRST_PUBLISHED:return l.Ru.get("podcasts.next-episode.first-published");case It.t5.LATEST_PUBLISHED:return l.Ru.get("podcasts.next-episode.latest-published");default:return}},Ni=({breakpoint:e,metadata:t,spec:a})=>{const{uri:s,trailer:r,topics:o,description:c,htmlDescription:d,rating:u}=t,x=(0,X.s)(),{spec:y,logger:f}=(0,We.r)(n.R,{data:{uri:s}}),k=(0,i.useMemo)((()=>y.aboutSectionFactory()),[y]),w=(0,i.useMemo)((()=>a.episodeListFactory()),[a]),S=(0,p.wA)(),P=(0,g.NC)(pt.Pfj,{loadingValue:!1}),R=(0,Y.W)(),E=(0,_e.V)(),{sortState:N}=(0,i.useContext)(Ba),I=(0,Nt.T)(),A=(0,Ha.c)(),{usePlayContextItem:B}=(0,Vt.P)({uri:s,metadata:{[Pi.W.SORTING_CRITERIA]:I.getPlayerSort(Da),[Pi.W.FILTERING_PREDICATE]:I.getPlayerFilter(N)}},{featureIdentifier:"show"}),{isActive:_,isPlaying:F,togglePlay:T}=B({uri:r?.uri||""}),U=(0,i.useCallback)((e=>{R({intent:"expand-description",type:"click"});const t=a.aboutSectionFactory().seeMoreButtonFactory(),i=e?t.hitUiReveal():t.hitUiHide();x.logInteraction(i)}),[x,R,a]),D=(0,i.useCallback)(((e,t)=>{const i=a.aboutSectionFactory().topicFactory(t).hitUiNavigate({destination:t.uri});x.logInteraction(i)}),[x,a]),M=r?{name:r.name,uri:r.uri,audio:{items:r.audio.items.map((e=>({url:e.url})))}}:null,L=(0,Ea.B)(t),O=(0,wi.C)(M,L),z=(0,i.useCallback)((()=>{r?.uri&&(E?O():(R({targetUri:r.uri,intent:F?"play":"pause",type:"click"}),T()))}),[O,E,F,R,T,r?.uri]),{ref:V,breakpoint:W}=(0,Si.x)({[st.E.MEDIUM]:0,[st.E.LARGE]:600}),H=o.length>0,Q=c||d,J=Q||H,Z=t.nextBestEpisode?.type===It.t5.LATEST_PUBLISHED&&P,ee=(0,xa.z)(),te=(0,xa.$)();return(0,G.jsxs)("div",{className:m()(ri,"contentSpacing",{[li]:e===st.E.LARGE}),ref:V,children:[(0,G.jsx)(Ra.q,{className:oi,gatedEntityRelations:t.gatedEntityRelations,upsellExplanation:t.upsellExplanation,hasAccess:t.hasGatedEntityRelationAccess}),(0,G.jsxs)("div",{className:ci,children:[J&&(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(h.E,{as:"h3",variant:"titleSmall",semanticColor:"textBase",className:xi,children:l.Ru.get("artist.about")}),Q&&(0,G.jsx)($.N,{maxLines:4,content:(c||"").trim(),onExpanded:U,htmlContent:d||void 0}),r&&(0,G.jsx)(qe.h,{menu:(0,G.jsx)(ga.b,{uri:r.uri,showUri:s,sharingInfo:r.sharingInfo}),children:(0,G.jsx)(K,{label:l.Ru.get("track-trailer"),className:yi,images:r.coverArt,title:r.name,duration:r.duration.milliseconds,moreButton:(0,G.jsx)(j.b,{menu:(0,G.jsx)(ga.b,{uri:r.uri,sharingInfo:r.sharingInfo,showUri:s}),children:(0,G.jsx)(b.e,{})}),onClick:z,isPlaying:F,isActive:_,size:q.LARGE,contentRating:r.contentRating?.label})}),(0,G.jsxs)("div",{className:bi,children:[u&&(0,G.jsx)("div",{className:ji,children:(0,G.jsx)(Ot,{rating:u,onClick:()=>{const e=k.ratingButtonFactory().hitUiReveal();f.logInteraction(e),S((0,v.eH)(s,t))}})}),H&&(0,G.jsx)(C.N,{topics:o,className:fi,onClick:D})]})]}),(0,G.jsx)(ha,{uri:s})]}),(0,G.jsx)(nt.o.Provider,{value:W,children:(0,G.jsxs)("div",{className:m()(ui,{[mi]:A}),"data-testid":"show-all-episode-list",children:[t.nextBestEpisode&&!Z&&(0,G.jsx)(Ea.q,{showMetadata:t,episode:t.nextBestEpisode.data,usePlayContextItem:B,status:Ei(t.nextBestEpisode.type),variant:"next-best-episode"}),(0,G.jsx)(ki,{spec:a}),(0,G.jsx)(Ri.r,{spec:w,children:(0,G.jsx)(Ja,{showMetadata:t,usePlayContextItem:B})})]})}),(0,G.jsx)(Ft.Z,{copyrights:[]}),(0,G.jsxs)("div",{className:di,children:[ee&&(0,G.jsx)(ya.w,{uri:s,title:l.Ru.get("internal-link-recommender.popular-episodes"),"data-testid":"popular-episodes-above"}),A&&(0,G.jsx)(Pa,{title:l.Ru.get("internal-link-recommender.more-podcasts-like-this"),uri:s,className:Ci}),te&&(0,G.jsx)(ya.w,{uri:s,title:l.Ru.get("internal-link-recommender.popular-episodes"),"data-testid":"popular-episodes-below"})]})]})},Ii=i.memo(Ni);var Ai=a(11241),Bi=a(73686);const _i=({reason:e})=>{const t=(0,g.NC)(pt.C2),a=function(e){switch(e){case"OTP":return l.Ru.get("podcasts.subscriber-indicator.otp");case"SUBSCRIPTION":return l.Ru.get("podcasts.subscriber-indicator.subscription");default:return""}}(e);return t&&a?(0,G.jsx)(h.E,{variant:"bodySmall",semanticColor:"textBase",className:vi,children:a}):null};const Fi=({metadata:e,backgroundColor:t})=>{const{uri:a,coverArt:i,name:s,podcastType:n,publisherName:r,gatedContentAccessReason:o}=e,c=(0,G.jsx)($t.H,{uri:a});return(0,G.jsxs)(Ye.z,{backgroundColor:t,children:[(0,G.jsx)(Je.h,{children:(0,G.jsx)(qe.h,{menu:c,children:(0,G.jsx)(Ze.X,{text:s,dragUri:a,dragLabel:s})})}),(0,G.jsx)(Ai.X,{children:(0,G.jsx)(qe.h,{menu:c,children:(0,G.jsx)(Bi.b,{loading:"eager",name:s,images:i,placeholderType:"show",shape:Bi.u.SQUARE})})}),(0,G.jsxs)(Qe.Y,{children:[(0,G.jsxs)(tt.B,{children:["SHOW"===n?l.Ru.get("type.show"):l.Ru.get("type.podcast"),o&&(0,G.jsx)(_i,{reason:o})]}),(0,G.jsx)(qe.h,{menu:c,children:(0,G.jsx)(it.mm,{dragUri:a,dragLabel:s,scaleAtMinWidth:it.tw,children:(0,G.jsx)("span",{"data-testid":"show-title",children:s})})}),(0,G.jsx)(at.g,{children:r})]})]})};var Ti=a(64526),Ui=a(97496),Di=a(36702),Mi=a(96600);const Li=({metadata:e,showId:t})=>{const{coverArt:a,name:s,uri:r,isSaved:o}=e,{spec:l}=(0,We.r)(n.R,{data:{uri:r}}),d=(0,i.useMemo)((()=>l.actionBarFactory()),[l]),u=(0,_t.H)(a[0]?.url||null),m=(0,nt.y)();return(0,G.jsxs)("section",{className:ni,children:[(0,G.jsx)(c.Q,{children:(0,Ht.hV)({showOrAudiobookName:s,type:"Podcast"})}),(0,G.jsx)(Bt.c,{artistOrShow:s,uri:r,entityType:Bt.p.PODCAST}),(0,G.jsx)(Fi,{metadata:e,backgroundColor:u}),(0,G.jsx)(Xt,{uri:r,name:s,isSaved:o,backgroundColor:u,spec:d}),(0,G.jsx)(Ii,{breakpoint:m,metadata:e,showId:t,spec:l})]})},Oi=(0,i.memo)((function(){const{showId:e=""}=(0,s.g)(),t=`spotify:show:${e}`,{data:a,error:n,redirectUri:c}=(0,Re.W)(t),{data:u,isLoading:m}=(0,Di.r)(t);if(c){const e=(0,o.Lce)(c);return(0,G.jsx)(Kt.$,{to:e.toURLPath(!0)})}const p=a&&(0,It.Go)(a);return!a||m||n?n instanceof Mi.W?(0,G.jsx)(d.LoadingPage,{hasError:!0,errorMessage:l.Ru.get("error-page.not-available-in-region.title")}):(0,G.jsx)(d.LoadingPage,{hasError:!!n,errorMessage:l.Ru.get("error.not_found.title.page")}):p?(0,G.jsx)(i.Suspense,{fallback:null,children:(0,G.jsx)(Ti.u,{pageId:r.$h.PODCAST_SHOW_AUDIOBOOK,uri:t,children:(0,G.jsx)(Ui.dj,{dynamicColors:u,children:(0,G.jsx)(qt,{metadata:a},`${!!a.consumptionCapExplanation}`)})})}):(0,G.jsx)(i.Suspense,{fallback:null,children:(0,G.jsx)(Ti.u,{pageId:r.$h.PODCAST,uri:t,children:(0,G.jsx)(_a,{uri:a.uri,children:(0,G.jsx)(Wa,{uri:a.uri,defaultSortParam:Oa(a.consumptionOrder),children:(0,G.jsx)(Ui.dj,{dynamicColors:u,children:(0,G.jsx)(Li,{showId:e,metadata:a})})})})})})}))},1429:(e,t,a)=>{a.d(t,{$:()=>s});var i=a(30758);const s=(e,t)=>{const a=(0,i.useRef)(e);(0,i.useEffect)((()=>{a.current=e}),[e]),(0,i.useEffect)((()=>{let e;function i(){e&&clearInterval(e)}if(null!==t)return e=setInterval((function(){a.current(i)}),t),i}),[t])}}}]);
//# sourceMappingURL=xpui-routes-show.js.map